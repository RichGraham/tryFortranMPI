module test_regression
  use mpi
  use mpi_variables
  use sum_func
  use funit
  implicit none
  double precision:: regression_tolerance=1e-5

contains
  @test
  subroutine initialise()
    !implicit none

    call MPI_INIT(ierror)
    call MPI_COMM_SIZE(MPI_COMM_WORLD, size_Of_Cluster, ierror)
    call MPI_COMM_RANK(MPI_COMM_WORLD, process_Rank, ierror)


    @assertEqual(root, 0 ,'Initialisation')

  end subroutine initialise
  !===========================================================================================



  @test
  subroutine test_sum()
    implicit none

    integer answer
    integer:: nTerms=8*9*10


    call MPI_Barrier(  MPI_COMM_WORLD, ierror)



    answer = sumFunc( nTerms)


    call MPI_Barrier(  MPI_COMM_WORLD, ierror)


    if( process_Rank == 0 ) then
       @assertEqual(answer, 10*nTerms + (nTerms+1)*nTerms/2 ,'Initialisation')
    end if

  end subroutine test_sum




  !===========================================================================================
  @test
  subroutine test_finalize()
    implicit none
    call MPI_FINALIZE(ierror)
  end subroutine test_finalize



end module test_regression
